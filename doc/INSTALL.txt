{{toc}}

!Hikiのインストールと設定

Hikiを動かすためには何はなくとも、まずRubyが必要です。[[Rubyホームページ|http://www.ruby-lang.org/ja/]]からダウンロードしてインストールしてください。

また、[[ここ|http://www.namaraii.com/hiki/hiki.cgi?%28Hiki%29%C6%B0%BA%EE%B4%C4%B6%AD]]に実際に動作した環境がまとめられていますので、ご参照ください。

!!前提ライブラリのインストール
Hikiは以下のライブラリがインストールされていることを前提にしています。

:strscan (0.6.5以降）:http://raa.ruby-lang.org/list.rhtml?name=strscan

これらについては上記のURLからダウンロード後、添付ドキュメントを参考にインストールしてください。なお、strscanはRuby 1.8から標準添付になりましたので1.8以上ではインストールの必要はありません。

!!インストール例で前提とする環境

一般的なCGIの実行を許可しているISPやレンタルサーバ上で利用する場合を想定し、以下のような環境を例に説明します。

*WWWサーバ: Apache 1.3.x
*ユーザ名: foo
*HikiのURL: http://www.hoge.example.org/~foo/hiki/
*上記URLのパス: /home/foo/public_html/hiki/
*データ格納用のパス: /home/foo/hiki/

!!CGIスクリプトの設定
配布アーカイブを展開し、中身をすべて/home/foo/public_html/hiki/にコピーします。
hiki.cgiがCGIスクリプト本体なので、WWWサーバの権限で実行可能なようにパーミッションを設定してください。

また、/usr/bin/envを使った起動ができない環境では、各ファイルの先頭をRubyのパスに書き換える必要があるでしょう。

!!.htaccessの作成
続いて、CGIの実行環境を整えます。''dot.htaccess''を''.htaccess''にリネームして、環境に合わせて書き換えます。添付のサンプルは以下のようになっています。

 Options +ExecCGI
 
 AddHandler cgi-script .cgi
 DirectoryIndex hiki.cgi
 
 <Files "hikiconf.rb">
	deny from all
 </Files>

ここでは、
*CGIの実行を可能にし、
*サフィックス「.cgi」のファイルをCGIと認識させ、
*hiki.cgiをデフォルトのファイルに設定し、
*hikiconf.rbの参照を禁止

という設定になっています。

!!データ格納用ディレクトリの作成
!!!data配下のコピーとパーミションの設定
展開したディレクトリ中にdataというディレクトリがあります。
このディレクトをどこかへコピーしてください。
このディレクトリの場所は、WWW経由でアクセスできない(''public_html''配下でない)場所が良いでしょう。

 $ cp -r data /home/foo/hiki

データ格納用のディレクトリ配下にある全てのファイルはWWWサーバの権限で書き込めるパーミッションにしておく必要があります。

 $ chmod -R og+w /home/foo/hiki/data

!!hikiconf.rbの作成
次に、''hikiconf.rb.sample''を''hikiconf.rb''にリネームして、内容を書き換えます。これはRubyスクリプトとして、CGIに直接読み込まれます。(requireされます）
Hikiの主要な設定はCGI経由で行えるので、最低限書き換えるべきなのは最初に出てくる''@data_path''だけです。

 @data_path = '/home/foo/hiki/data'

''hikiconf.rb''には、他にもいろいろな設定項目を記述できます。詳細については、''hikiconf.rb.sample''中のコメントを参照してください。

!Hikiの実行

HikiをインストールしたURL（ここではhttp://www.hoge.example.org/~foo/hiki/）をブラウザで開いてみてください。FrontPageが表示されればインストールは成功です。

ページの上部には以下のようなメニューが表示されているはずです。

 [ 新規作成 | 編集 | 差分 ] [ FrontPage | 一覧 | 検索 | 更新履歴 ] [ 管理 ] 

以下、これらのメニューについて説明します。

!!新規作成

「新規作成」のアンカをクリックすると「新規作成」画面へ遷移し新しくページを追加する
ことができます。

!!編集

「編集」のアンカをクリックすると参照しているページの内容を編集することができます。

Hikiにはページ単位の「凍結」という考え方があります。
管理者がページを編集して保存する際に「ページの凍結」というチェックボックスをチェックし、管理者用パスワードを入力することにより、そのページは凍結されます。凍結されたページを編集するには管理者用のパスワードを入力する必要があります。

!!差分

「差分」のアンカをクリックすると参照しているページの最新版と、１つ前の版との内容の差分を参照することができます。

!!FrontPage

「FrontPage」のアンカをクリックするとHikiのトップページに遷移します。

!!一覧

「一覧」のアンカをクリックすると作成された全てのページを一覧で表示します。一覧画面では、各ページの最終更新日時、凍結されているか否かを参照することができます。

!!検索

「検索」のアンカをクリックすると「検索」画面に遷移します。検索画面で検索したい
キーワードを入力し、「検索」ボタンを押下すると、全てのページ中から入力したキーワードを含むページが一覧されます。

!!更新履歴

「更新履歴」のアンカをクリックすると作成された全てのページを更新日時が新しい順に
並び替えて一覧表示します。

!!管理

「管理」のアンカをクリックすると管理者用ページに遷移し、以下の項目を設定することができます。

*サイト名
*著者名（サイト管理者名）
*メールアドレス（サイト管理者）
*管理者用パスワード
*更新時のメール通知有無
*テーマ
*サイドバーの利用有無

''【重要】インストールが成功したら、すぐに「管理」画面で管理者用パスワードを設定してください。''

!おわりに
このドキュメントはtDiary配布パッケージのdoc/README.htmlを参考にさせていただきました。tDiaryの作者、たださんに感謝します。
